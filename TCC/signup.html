<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Criar Conta | Psycotech</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .signup-container {
      max-width: 500px;
      margin: 60px auto;
      background: #fff;
      padding: 35px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      text-align: center;
    }
    .signup-container h2 {
      color: #78aaec;
      margin-bottom: 20px;
      font-size: 2rem;
    }

    .signup-container input,
    .signup-container select {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 2px solid #78aaec;
      font-size: 1.05rem;
    }

    .signup-container button {
      width: 100%;
      padding: 12px;
      border: none;
      background: #00d9c0;
      color: #fff;
      font-size: 1.1rem;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      transition: background .3s;
      margin-top: 5px;
    }

    .signup-container button:hover {
      background: #00b99a;
    }

    .signup-container p {
      margin-top: 10px;
    }

    .signup-container a {
      color: #78aaec;
      font-weight: bold;
      text-decoration: none;
    }

    .signup-container a:hover {
      text-decoration: underline;
    }

    /* Seção opcional para agendamento */
    .agendamento-box {
      margin-top: 25px;
      padding: 15px;
      background: #f0f4f8;
      border-radius: 10px;
      text-align: left;
    }

    .agendamento-box h3 {
      font-size: 1.3rem;
      color: #78aaec;
      margin-bottom: 10px;
      text-align: center;
    }

    .agendamento-box label {
      font-size: 1rem;
      font-weight: 600;
      display: block;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

<header>
  <h1>Psycotech</h1>
</header>

<div class="signup-container">
  <h2>Criar Conta</h2>
  
  <form id="signup-form">
    <input type="text" placeholder="Nome completo" required>
    <input type="email" placeholder="E-mail" required>
    <input type="password" id="senha" placeholder="Senha" required>
    <input type="password" id="confirmar-senha" placeholder="Confirmar senha" required>

    <!-- SEÇÃO OPCIONAL DE AGENDAMENTO -->
    <div class="agendamento-box">
      <h3>Agendar primeira consulta (opcional)</h3>

      <label for="psicologo">Escolha o psicólogo:</label>
      <select id="psicologo">
        <option selected disabled>Selecione</option>
        <option value="Maria Silva">Dra. Maria Silva</option>
        <option value="João Souza">Dr. João Souza</option>
        <option value="Ana Pereira">Dra. Ana Pereira</option>
      </select>

      <label>Data:</label>
      <input type="date">

      <label>Horário:</label>
      <input type="time">
    </div>

    <button type="submit">Criar Conta</button>
  </form>

  <p>Já possui conta? <a href="login.html">Entrar</a></p>
</div>

<footer>
  <p>© 2025 Psycotech</p>
</footer>

<script>
  document.getElementById('signup-form').addEventListener('submit', async function(event) {
    event.preventDefault();

    const nome = document.querySelector('input[type="text"]').value;
    const email = document.querySelector('input[type="email"]').value;
    const senha = document.getElementById('senha').value;
    const confirmarSenha = document.getElementById('confirmar-senha').value;

    const psicologo = document.getElementById('psicologo').value;
    const dataConsulta = document.querySelector('input[type="date"]').value;
    const horarioConsulta = document.querySelector('input[type="time"]').value;

    // 1️⃣ Verificação de senhas iguais
    if (senha !== confirmarSenha) {
      alert('As senhas não coincidem.');
      return;
    }

    try {
      // 2️⃣ Criando o usuário no Firebase Authentication
      const userCredential = await auth.createUserWithEmailAndPassword(email, senha);
      const user = userCredential.user;

      // 3️⃣ Salvando informações no Firestore
      await db.collection("users").doc(user.uid).set({
        nome: nome,
        email: email,
        psicologo: psicologo !== "Selecione" ? psicologo : null,
        dataConsulta: dataConsulta || null,
        horarioConsulta: horarioConsulta || null,
        criadoEm: new Date()
      });

      alert("Conta criada com sucesso!");
      window.location.href = "login.html"; // redireciona

    } catch (error) {
      // 4️⃣ Tratamento de erros
      console.error(error);

      if (error.code === "auth/email-already-in-use") {
        alert("Este e-mail já está cadastrado.");
      } else if (error.code === "auth/invalid-email") {
        alert("E-mail inválido.");
      } else if (error.code === "auth/weak-password") {
        alert("A senha deve ter no mínimo 6 caracteres.");
      } else {
        alert("Ocorreu um erro ao criar a conta.");
      }
    }
  });

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
  // COLE AQUI SEU firebaseConfig (o mesmo que você viu no Firebase)
  const firebaseConfig = {
    apiKey: "AIzaSyBHoTtDtOfqKPaClLIVJ2qjPeCVDepblaI",
    authDomain: "psycotech-ad8b9.firebaseapp.com",
    projectId: "psycotech-ad8b9",
    storageBucket: "psycotech-ad8b9.firebasestorage.app",
    messagingSenderId: "962546360438",
    appId: "1:962546360438:web:4efb54ed9c14ed33c8ff57"
  };

  firebase.initializeApp(firebaseConfig);

  const auth = firebase.auth();
  const db = firebase.firestore();
</script>

</script>
  

</body>
</html>

